<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/App/Search/search.component.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">App</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/App/app.js~App.html">App</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">App/Search</div><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/App/Search/list.component.js~SearchList.html">SearchList</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/App/Search/search.component.js~SearchComponent.html">SearchComponent</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/App/Search/search.component.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">/**
 * Created on 2017-01-23.
 * @author: Gman Park
 */

import Rx from &apos;rxjs/Rx&apos;;

import SearchList from &apos;./list.component&apos;;

// API key for fetch data.
const AppKey = &apos;f0c12da8-2ef4-3e24-8815-e2f347909a80&apos;;

export default class SearchComponent {
    constructor(htOption) {
        // initialized searchList Component
        this.oSearchList = new SearchList();

        // setting default keyword
        this.searchKeyword = htOption.searchKeyword ? htOption.searchKeyword : &apos;javascript&apos;;

        this.insertHeader();
        this.attachEvent();
        this.search();  // init search
    }

    insertHeader() {
        let headerWrapper = document.querySelector(&apos;.header&apos;);
        let header = document.querySelector(&apos;#tmpl_header&apos;);

        let cloneElement = document.importNode(header.content, true);
        headerWrapper.appendChild(cloneElement);
    }

    attachEvent() {
        Rx.Observable.fromEvent(document.querySelector(&apos;.inp&apos;), &apos;input&apos;)
            .debounceTime(400)
            .distinctUntilChanged()
            .scan(function (prev, current) {
                if (prev == null) {
                    return null;
                }
                return current;
            })
            .filter((e) =&gt; {
                let text = e.target.value;

                if (text != null &amp;&amp; text != &quot;&quot;) {
                    // searchText null validation.
                    this.searchKeyword = text;
                    return text;
                }
            })
            .subscribe(
                () =&gt; {
                    this.search();                    // success
                },
                (err) =&gt; {
                    console.log(err);                    // fail
                }
            );
    }

    search() {
        Rx.Observable.ajax({
            url: &apos;http://apis.skplanetx.com/11st/v2/common/products?appKey=&apos; + AppKey + &apos;&amp;searchKeyword=&apos; + this.searchKeyword + &apos;&amp;sortCode=A&apos;,
            crossDomain: true,
            headers: {&quot;Content-type&quot;: &quot;application/json&quot;, &quot;Accept&quot;: &quot;application/json&quot;}
        })
            .retry(3)
            .map(e =&gt; e.response)
            .map(e =&gt; {
                if (e.hasOwnProperty(&apos;ProductSearchResponse&apos;)) {
                    return e.ProductSearchResponse.Products.Product;
                }
            })
            .subscribe(
                (res) =&gt; {
                    if (res.length != 0) {
                        this.oSearchList.render(res);
                    }
                },
                (err) =&gt; {
                    console.log(err);
                }
            );
    }
}</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
